{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["// import calendar library\nimport flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\n\n// import alerts library\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst startButton = document.querySelector(\"button\");\nconst dateInput = document.querySelector(\"input\");\nconst timerFields = {\n  days: document.querySelector(\"span[data-days]\"),\n  hours: document.querySelector(\"span[data-hours]\"),\n  minutes: document.querySelector(\"span[data-minutes]\"),\n  seconds: document.querySelector(\"span[data-seconds]\")\n};\n\nlet timerId = null; //save global timer id to be able to clean it when it expires\n\n//start button is inactive on load until we select a date\nstartButton.disabled = true;\n\nlet userSelectedDate = new Date();\n\n//#region flatpickr setup\nconst flatpickrOptions = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n    onClose(selectedDates) {\n        if (selectedDates[0] < Date.now()) {\n          iziToast.show({\n            message: 'Please choose a date in the future',\n            messageSize: '16px',\n            messageLineHeight: '24px',\n            messageColor: 'white',\n            position: 'topRight',\n            backgroundColor: '#EF4040',\n            theme: 'dark',\n            iconUrl: \"./img/error-alert.svg\",\n            iconColor: 'white',\n            progressBarColor: '#B51B1B',\n          });\n          startButton.disabled = true;\n          return;\n        }\n        userSelectedDate = selectedDates[0];\n      startButton.disabled = false; //enable button back after valid date is selected\n  },\n};\n\nconst flatpickrInstance = new flatpickr(\"#datetime-picker\", flatpickrOptions);\n//#endregion flatpickr setup\n\n//#region utils\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n\nfunction addLeadingZero(value) {\n  return String(value).padStart(2, '0');\n}\n\n//#endregion utils\n\nstartButton.addEventListener('click', () => timerId = setInterval(() => {\n  //maybe move excessive calculations to global variables/functions\n  //but then wont be able to respond to inner delays of browser/cpu \n  const timeLeft = userSelectedDate - Date.now();\n  if (timeLeft > 0) {\n    const convertedTimeLeft = convertMs(timeLeft);\n    Object.keys(convertedTimeLeft).forEach(key => \n      timerFields[key].textContent = convertedTimeLeft[key] < 10 ? addLeadingZero(convertedTimeLeft[key]) : convertedTimeLeft[key]\n    );\n  }\n  else {\n    clearInterval(timerId);\n    //enable controlls when timer runs out\n    dateInput.disabled = false;\n  }\n}, 1000));\n\n//disable controlls after click\nstartButton.addEventListener('click', () => {\n  dateInput.disabled = true;\n  startButton.disabled = true;\n})"],"names":["startButton","dateInput","timerFields","timerId","userSelectedDate","flatpickrOptions","selectedDates","iziToast","flatpickr","convertMs","ms","days","hours","minutes","seconds","addLeadingZero","value","timeLeft","convertedTimeLeft","key"],"mappings":"+IAQA,MAAMA,EAAc,SAAS,cAAc,QAAQ,EAC7CC,EAAY,SAAS,cAAc,OAAO,EAC1CC,EAAc,CAClB,KAAM,SAAS,cAAc,iBAAiB,EAC9C,MAAO,SAAS,cAAc,kBAAkB,EAChD,QAAS,SAAS,cAAc,oBAAoB,EACpD,QAAS,SAAS,cAAc,oBAAoB,CACtD,EAEA,IAAIC,EAAU,KAGdH,EAAY,SAAW,GAEvB,IAAII,EAAmB,IAAI,KAG3B,MAAMC,EAAmB,CACvB,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACf,QAAQC,EAAe,CACnB,GAAIA,EAAc,CAAC,EAAI,KAAK,IAAG,EAAI,CACjCC,EAAS,KAAK,CACZ,QAAS,qCACT,YAAa,OACb,kBAAmB,OACnB,aAAc,QACd,SAAU,WACV,gBAAiB,UACjB,MAAO,OACP,QAAS,wBACT,UAAW,QACX,iBAAkB,SAC9B,CAAW,EACDP,EAAY,SAAW,GACvB,MACV,CACQI,EAAmBE,EAAc,CAAC,EACpCN,EAAY,SAAW,EAC1B,CACH,EAE0B,IAAIQ,EAAU,mBAAoBH,CAAgB,EAI5E,SAASI,EAAUC,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAS,CAC1C,CAEA,SAASC,EAAeC,EAAO,CAC7B,OAAO,OAAOA,CAAK,EAAE,SAAS,EAAG,GAAG,CACtC,CAIAhB,EAAY,iBAAiB,QAAS,IAAMG,EAAU,YAAY,IAAM,CAGtE,MAAMc,EAAWb,EAAmB,KAAK,IAAK,EAC9C,GAAIa,EAAW,EAAG,CAChB,MAAMC,EAAoBT,EAAUQ,CAAQ,EAC5C,OAAO,KAAKC,CAAiB,EAAE,QAAQC,GACrCjB,EAAYiB,CAAG,EAAE,YAAcD,EAAkBC,CAAG,EAAI,GAAKJ,EAAeG,EAAkBC,CAAG,CAAC,EAAID,EAAkBC,CAAG,CAC5H,CACL,MAEI,cAAchB,CAAO,EAErBF,EAAU,SAAW,EAEzB,EAAG,GAAI,CAAC,EAGRD,EAAY,iBAAiB,QAAS,IAAM,CAC1CC,EAAU,SAAW,GACrBD,EAAY,SAAW,EACzB,CAAC"}